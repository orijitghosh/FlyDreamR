% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/convMasterToMetaBatch.R
\name{convMasterToMetaBatch}
\alias{convMasterToMetaBatch}
\title{Batch Convert Multiple Master Files to FlyDreamR Metadata Format}
\usage{
convMasterToMetaBatch(
  metafiles,
  startDT = "2024-04-11 06:00:00",
  endDT = "2024-04-16 06:00:00",
  output_dir = "."
)
}
\arguments{
\item{metafiles}{Character vector containing full paths to all master files
to process. Can be generated using \code{Sys.glob()} or \code{list.files()}.
No default value.}

\item{startDT}{Character string. Expected experimental start date-time
\strong{applied to all files}. Format: \code{"YYYY-MM-DD HH:MM:SS"}.
Default: \code{"2024-04-11 06:00:00"}.}

\item{endDT}{Character string. Expected experimental end date-time
\strong{applied to all files}. Format: \code{"YYYY-MM-DD HH:MM:SS"}.
Default: \code{"2024-04-16 06:00:00"}.}

\item{output_dir}{Character string. Directory where all metadata CSV files
will be saved. Defaults to current working directory (\code{"."}).
Created if it doesn't exist.}
}
\value{
A single \code{data.frame} combining metadata from all successfully
processed master files. Contains the same columns as individual metadata
files (see \code{\link{convMasterToMeta}} for column details).

Individual CSV files are also written to \code{output_dir}, one per
master file processed.

If a file fails to process, it is skipped with a warning message, and
processing continues with remaining files.
}
\description{
Processes multiple DAM master files in batch, converting each to the metadata
format required by FlyDreamR. This is a convenient wrapper around
\code{\link{convMasterToMeta}} that handles multiple files with the same
start/end times.

The function validates each master file against its corresponding monitor
file, generates individual metadata CSV files, and returns a combined
metadata table for all processed files.
}
\details{
\subsection{Batch Processing Workflow}{

For each master file, the function:
\enumerate{
\item Calls \code{\link{convMasterToMeta}} with provided parameters
\item Validates start/end times against the monitor file
\item Saves individual metadata CSV
\item Collects metadata for combining
\item Handles errors gracefully (skips failed files)
}
}

\subsection{Error Handling}{

\itemize{
\item Each file is wrapped in \code{tryCatch}
\item Failed files generate a warning but don't stop processing
\item Successfully processed files are combined in the final output
\item Summary statistics printed at completion
}
}

\subsection{Use Cases}{

Use batch processing when you have:
\itemize{
\item Multiple monitor files from the same experiment (same timing)
\item Multiple replicates run simultaneously
\item Multiple blocks in a large-scale screen
}

\strong{Important}: All files must share the same start/end times. If your
master files have different timings, process them separately using
\code{\link{convMasterToMeta}}.
}

\subsection{Performance}{

Processing speed depends on:
\itemize{
\item Number of files
\item Size of monitor files (for validation)
\item I/O speed
}
Typical: 1-2 seconds per file.
}
}
\section{Master File Format}{

Each master file should follow the same format as described in
\code{\link{convMasterToMeta}}:
\itemize{
\item Tab-delimited text file
\item No header row
\item 8 columns: Monitor, Channel, Line, Sex, Treatment, Rep, Block, SetupCode
\item Only rows with SetupCode = 1 are processed
}
}

\examples{
\dontrun{
# Find all master files in a directory
master_files <- Sys.glob("experiment_data/master*.txt")

# Process all with same start/end times
all_metadata <- convMasterToMetaBatch(
  metafiles = master_files,
  startDT = "2024-01-15 09:00:00",
  endDT = "2024-01-20 09:00:00",
  output_dir = "processed_metadata"
)

# View combined results
print(all_metadata)
table(all_metadata$genotype)

# Alternatively, specify files explicitly
master_files <- c(
  "data/master53.txt",
  "data/master54.txt",
  "data/master55.txt"
)
metadata <- convMasterToMetaBatch(master_files)

# Use list.files() with pattern matching
master_files <- list.files(
  path = "raw_data",
  pattern = "^master.*\\\\.txt$",
  full.names = TRUE
)
metadata <- convMasterToMetaBatch(
  metafiles = master_files,
  output_dir = "metadata"
)
}

}
\seealso{
\code{\link{convMasterToMeta}} for single file processing and format details
\code{\link{HMMDataPrep}} for using the generated metadata
\code{\link[base]{Sys.glob}} for finding files with wildcards
}
